{% extends "base.twig" %}

{% block title %}Dashboard{% endblock %}

{% block content %}
<div class="min-h-screen bg-gradient-to-br from-gray-100 to-gray-200 dark:from-gray-800 dark:to-gray-900">
  <div class="container mx-auto px-4 py-8">
    <h1 class="text-3xl font-bold text-gray-800 dark:text-white mb-8">Dashboard</h1>

    {% if events %}
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden">
      <div class="p-6 border-b border-gray-200 dark:border-gray-700">
        <h2 class="text-2xl font-semibold text-gray-800 dark:text-white">Event List</h2>
      </div>
      <div class="overflow-x-auto">
        <table class="w-full">
          <thead class="bg-gray-50 dark:bg-gray-700">
            <tr>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Title</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Location</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Max capacity</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Status</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Category</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Start date</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">End date</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Price</th>
            </tr>
          </thead>
          <tbody class="bg-white dark:bg-gray-800 divide-y text-gray-500 dark:text-gray-300 divide-gray-200 dark:divide-gray-700">
            {% for event in events %}
            <tr class="hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200">
              <td class="px-6 py-4 whitespace-nowrap">
                <a href="/organizer/MyEvents/eventStats/{{event["id"]}}" class="font-bold text-transparent bg-clip-text bg-gradient-to-r from-orange-500 to-pink-500 hover:from-pink-500 hover:to-orange-500 transition-all duration-300">{{event["title"]}}</a>
              </td>
              <td class="px-6 py-4 whitespace-nowrap">{{event["location"]}}</td>
              <td class="px-6 py-4 whitespace-nowrap">{{event["max_capacity"]}}</td>
              <td class="px-6 py-4 whitespace-nowrap">
                <span class="inline-flex text-xs leading-5 font-semibold rounded-full bg-gradient-to-r from-orange-500 to-pink-500 text-white py-2 px-4">
                  {{event["state"]}}
                </span>
              </td>
              <td class="px-6 py-4 whitespace-nowrap">{{event["category_name"]}}</td>
              <td class="px-6 py-4 whitespace-nowrap">{{event["start_date"]|date("d/m/Y")}}</td>
              <td class="px-6 py-4 whitespace-nowrap">{{event["end_date"]|date("d/m/Y")}}</td>
              <td class="px-6 py-4 whitespace-nowrap">${{event["price"]}}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
    
    {% elseif participants %}
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden">
      <div class="p-6 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
        <h2 class="text-2xl font-semibold text-gray-800 dark:text-white">Participant List</h2>
        <div class="relative" x-data="{ open: false }">
          <button @click="open = !open" class="inline-flex text-xs leading-5 font-semibold bg-gradient-to-r from-orange-500 to-pink-500 hover:from-orange-600 hover:to-pink-600 text-white py-2 px-4 rounded-lg shadow-md transition duration-200 ease-in-out">
            Export As â–¼
          </button>
          <div x-show="open" @click.away="open = false" class="absolute right-0 mt-2 w-48 bg-white dark:bg-gray-700 rounded-lg shadow-xl z-10">
            <a href="participant/csv" class="block px-4 py-2 text-gray-800 dark:text-white hover:bg-gray-100 dark:hover:bg-gray-600">CSV</a>
            <a href="participant/excel" class="block px-4 py-2 text-gray-800 dark:text-white hover:bg-gray-100 dark:hover:bg-gray-600">Excel</a>
          </div>
        </div>
      </div>
      <div class="overflow-x-auto">
        <table class="w-full">
          <thead class="bg-gray-50 dark:bg-gray-700">
            <tr>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">ID</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Participant name</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Ticket type</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Status</th>
            </tr>
          </thead>
          <tbody class="bg-white dark:bg-gray-800 text-gray-500 dark:text-gray-300 divide-y divide-gray-200 dark:divide-gray-700">
            {% for participant in participants %}
            <tr class="hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200">
              <td class="px-6 py-4 whitespace-nowrap">{{participant["id"]}}</td>
              <td class="px-6 py-4 whitespace-nowrap">{{participant["participant_name"]}}</td>
              <td class="px-6 py-4 whitespace-nowrap">{{participant["ticket_type"]}}</td>
              <td class="px-6 py-4 whitespace-nowrap">
                <span class="text-xs font-semibold rounded-full bg-gradient-to-r {% if participant["status"]=="active"%}bg-green-400 text-green-800{%else%}bg-red-400 text-red-700{%endif%} py-2 px-4">
                  {{participant["status"]}}
                </span>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>

    {% elseif eventstats %}
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      <a href="{{eventstats["event_id"]}}/participant" class="block">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 hover:shadow-xl transition duration-200 ease-in-out">
          <div class="flex items-center">
            <div class="p-3 rounded-full bg-indigo-600 bg-opacity-75">
              <svg class="h-8 w-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
              </svg>
            </div>
            <div class="ml-4">
              <h4 class="text-2xl font-semibold text-gray-700 dark:text-white">{{eventstats["participant_count"]}}</h4>
              <div class="text-gray-500 dark:text-gray-400">Participant Count</div>
            </div>
          </div>
        </div>
      </a>
      <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6">
        <div class="flex items-center">
          <div class="p-3 rounded-full bg-green-600 bg-opacity-75">
            <svg class="h-8 w-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
          </div>
          <div class="ml-4">
            <h4 class="text-2xl font-semibold text-gray-700 dark:text-white">${{eventstats["total_revenue"]}}</h4>
            <div class="text-gray-500 dark:text-gray-400">Revenue</div>
          </div>
        </div>
      </div>
      <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6">
        <div class="flex items-center">
          <div class="p-3 rounded-full bg-yellow-600 bg-opacity-75">
            <svg class="h-8 w-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path>
            </svg>
          </div>
          <div class="ml-4">
            <h4 class="text-2xl font-semibold text-gray-700 dark:text-white">{{eventstats["max_capacity"]-eventstats["participant_count"]}}</h4>
            <div class="text-gray-500 dark:text-gray-400">Available seats</div>
          </div>
        </div>
      </div>
    </div>
    {% endif %}
  </div>
</div>
{% endblock %}